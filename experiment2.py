from detector import *

res = []
strs = config['save_path'].strip('/')
wins = 700
checked = list(range(5, 11, 1))
for stride in range(4, 11, 2):
    config['maxlen'] = wins
    config['stride'] = int(wins * stride * 0.1)
    config['save_path'] = strs+'_stride'+str(stride * 0.1)+'/'
    print(config['save_path'])
    maxs = 0.5
    if stride not in checked:
       train(config, maxs)
    pred,label,acc = predict(config)
    print(acc)
    fpr,tpr,roc_auc = cal_roc(pred,label)
    label = 'overlap ratio: %.1f' % (stride * 0.1)
    res.append([fpr,tpr,roc_auc,label])

savefig(res,0)
savefig(res,1)
savefig(res,'micro')
