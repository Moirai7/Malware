from graph_detector import *
from utils import utils
from utils.utils import *

res = []
utils.sample='.100'
pred, label, acc = predict()
print(acc)
fpr,tpr,roc_auc = cal_roc(pred,label)
label = '0 ~ 200'
res.append([fpr,tpr,roc_auc,label])

utils.sample='.300'
pred, label, acc = predict()
print(acc)
fpr,tpr,roc_auc = cal_roc(pred,label)
label = '200 ~ 400'
res.append([fpr,tpr,roc_auc,label])

utils.sample='.400'
pred, label, acc = predict()
print(acc)
fpr,tpr,roc_auc = cal_roc(pred,label)
label = '400 ~ 800'
res.append([fpr,tpr,roc_auc,label])

utils.sample='.1000'
pred, label, acc = predict()
print(acc)
fpr,tpr,roc_auc = cal_roc(pred,label)
label = '800 ~ 1500'
res.append([fpr,tpr,roc_auc,label])

utils.sample='.2000'
pred, label, acc = predict()
print(acc)
fpr,tpr,roc_auc = cal_roc(pred,label)
label = '1500 ~ 4000'
res.append([fpr,tpr,roc_auc,label])

utils.sample='.3000'
pred, label, acc = predict()
print(acc)
fpr,tpr,roc_auc = cal_roc(pred,label)
label = '>= 4000'
res.append([fpr,tpr,roc_auc,label])

savefig(res,0)
savefig(res,1)
savefig(res,'micro')
