import graph_detector as gd
from graph_detector import *

from utils.utils import cal_roc,savefig
import datetime
# To test hid_units

maxs = {6:0.96396}
res = []
for i,v in maxs.items():
     print(i,v)
     gd.hid_units = [i]
     gd.acc = v
     gd.save_path = 'model/graph_detector/'+str(gd.withmatmul)+'_'+str(gd.withattention)+'_label_1_'+str(gd.hid_units[0]) +'/'
     '''
     pred,label,acc = predict()
     print(pred,label,acc)
     fpr,tpr,roc_auc = cal_roc(pred, label)
     label = 'hide_units: %d' % i
     res.append([fpr,tpr,roc_auc,label])
     '''
     oldtime=datetime.datetime.now()
     train()
     newtime=datetime.datetime.now()
     print('%s microseconds'%(newtime-oldtime).seconds)

savefig(res,0)
savefig(res,1)
savefig(res,'micro')
