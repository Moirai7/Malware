import csv
import pandas as pd
import numpy as np
def readcsv(fn):
	csv_reader = csv.reader(open(fn))
	data = []
	for row in csv_reader:
		data.append(row[2:])
	#return pd.DataFrame(data)
	return np.asarray(data)

import matplotlib
matplotlib.use('Agg')
import matplotlib.pyplot as plt

def calfreq(datas, k):
	plt.rcParams['savefig.dpi'] = 600
	plt.rcParams['figure.dpi'] = 600
	plt.rcParams['font.size'] = 2
	plt.clf()
	x = np.arange(k)+1
	title = ["Adware","Backdoor","Trojan-Downloader","Trojan-Ransom","Worm","Benign"]
	for data, i, t in zip(datas,range(1,7),title):
		plt.subplot(2,3,i)
		data = [n for k in data for n in k]
		v, n = np.unique(data, return_counts=True)
		n = dict(list(reversed(sorted(dict(zip(n,v)).items())))[0:k])
		plt.bar(x, n.keys())
		plt.xticks(x, list(n.values()), fontsize=2, rotation=90)
		plt.yticks(fontsize = 3)
		for a, b in zip(x, n.keys()):
			plt.text(a, b+0.05, b, ha='center', va='bottom', fontsize=2)
		plt.title(t, fontsize=5)
	plt.tight_layout()
	plt.savefig('try.jpg', dpi=600)       

def callens(data):
	plt.rcParams['savefig.dpi'] = 600
	plt.rcParams['figure.dpi'] = 600
	plt.clf()
	
data1 = readcsv("apiseq_all_AdWare.csv")
data2 = readcsv("apiseq_all_Backdoor.csv")
data3 = readcsv("apiseq_all_Trojan-Downloader.csv")
data4 = readcsv("apiseq_all_Trojan-Ransom.csv")
data5 = readcsv("apiseq_all_Worm.csv")
data6 = readcsv("apiseq_benign_merge.csv")
calfreq([data1,data2,data3,data4,data5,data6], 10)
