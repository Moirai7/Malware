from detector import *
import sys
lens = sys.argv[1]

config = define()
config['cell_type'] = 'lstm'
config['birnn'] = True
config['save_path'] = 'model/backup/'+config['cell_type']+'_'+str(config['birnn'])+'_'+str(config['depth'])+'_'+config['model']+'_wins'+lens+'/'
res = []

config['valid'] = 'data_windows/valid_100.seq'
pred, label, acc = predict(config)
print(acc)
fpr,tpr,roc_auc = cal_roc(pred,label)
label = '0 ~ 200'
res.append([fpr,tpr,roc_auc,label])

config['valid'] = 'data_windows/valid_300.seq'
pred, label, acc = predict(config)
print(acc)
fpr,tpr,roc_auc = cal_roc(pred,label)
label = '200 ~ 400'
res.append([fpr,tpr,roc_auc,label])

config['valid'] = 'data_windows/valid_400.seq'
pred, label, acc = predict(config)
print(acc)
fpr,tpr,roc_auc = cal_roc(pred,label)
label = '400 ~ 800'
res.append([fpr,tpr,roc_auc,label])

config['valid'] = 'data_windows/valid_1000.seq'
pred, label, acc = predict(config)
print(acc)
fpr,tpr,roc_auc = cal_roc(pred,label)
label = '800 ~ 1500'
res.append([fpr,tpr,roc_auc,label])

config['valid'] = 'data_windows/valid_2000.seq'
pred, label, acc = predict(config)
print(acc)
fpr,tpr,roc_auc = cal_roc(pred,label)
label = '1500 ~ 4000'
res.append([fpr,tpr,roc_auc,label])

config['valid'] = 'data_windows/valid_3000.seq'
pred, label, acc = predict(config)
print(acc)
fpr,tpr,roc_auc = cal_roc(pred,label)
label = '>= 4000'
res.append([fpr,tpr,roc_auc,label])

savefig(res,0)
savefig(res,1)
savefig(res,'micro')
'''
config['valid'] = 'data_windows/valid_long.seq'
pred, label, acc = predict(config)
print(acc)
fpr,tpr,roc_auc = cal_roc(pred,label)
config['valid'] = 'data_windows/valid_short.seq'
pred, label, acc = predict(config)
print(acc)
fpr,tpr,roc_auc = cal_roc(pred,label)

'''
