from detector import *
import datetime
cell_type = ['rnn','lstm','gru']
model = ['rnn','att1','att2','2att']
res = []
checked = {"model/detector/rnn_True_rnn/":0.895896, "model/detector/rnn_False_rnn/":0.907908, "model/detector/lstm_True_rnn/":0.920921, "model/detector/lstm_False_rnn/":0.931932,"model/detector/gru_True_rnn/":0.906907, "model/detector/gru_False_rnn/":0.915916,"model/detector/rnn_True_att1/":0.938939,"model/detector/rnn_False_att1/":0.947948, "model/detector/lstm_True_att1/":0.941942,"model/detector/lstm_False_att1/":0.947948,"model/detector/gru_True_att1/":0.947948,"model/detector/gru_False_att1/":0.958959,"model/detector/rnn_True_att2/":0.941942,"model/detector/rnn_False_att2/":0.940941,"model/detector/lstm_True_att2/":0.954955,"model/detector/lstm_False_att2/":0.947948,"model/detector/gru_True_att2/":0.937938,"model/detector/gru_False_att2/":0.943944,"model/detector/rnn_True_2att/":0.947948,"model/detector/rnn_False_2att/":0.950951,"model/detector/lstm_True_2att/":0.962963,"model/detector/lstm_False_2att/":0.937938,"model/detector/gru_True_2att/":0.963964,"model/detector/gru_False_2att/":0.958959}

#cell_type = ['rnn','gru']
for m in model:
   for c in cell_type:
     for k in [ False, True]:
        config['model']= m
        config['cell_type']=c
        config['birnn']=k
        
        config['save_path'] = 'model/detector/'+config['cell_type']+'_'+str(config['birnn'])+'_'+config['model']+'/'
        print(config['save_path'])
        if config['save_path'] not in checked.keys():
            oldtime=datetime.datetime.now()
            train(config, checked[config['save_path']])
            newtime=datetime.datetime.now()
            print(config['save_path'])
            print('%s microseconds'%(newtime-oldtime).seconds)
        else:
            print(config['save_path'])
            pred,label,acc = predict(config)
            print(acc)
            fpr,tpr,roc_auc = cal_roc(pred,label)
            label = config['model']
            res.append([fpr,tpr,roc_auc,label])

'''
savefig(res,0)
savefig(res,1)
savefig(res,'micro')
'''
