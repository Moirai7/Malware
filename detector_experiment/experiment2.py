from detector import *
import datetime

config['cell_type'] = 'lstm'
config['birnn'] = True
config['save_path'] = 'model/detector/'+config['cell_type']+'_'+str(config['birnn'])+'_'+str(config['depth'])+'_'+config['model']+'/'

res = []
strs = config['save_path'].strip('/')
wins = 300
checked = list(range(4, 11, 2))
for stride in range(4, 11, 2):
    config['maxlen'] = wins
    config['stride'] = int(wins * stride * 0.1)
    config['save_path'] = strs+'_stride'+str(round(stride * 0.1, 1))+'/'
    print(config['save_path'])
    maxs = 0.5
    if stride not in checked:
       oldtime=datetime.datetime.now()  
       train(config, maxs)
       newtime=datetime.datetime.now()
       print('%s microseconds'%(newtime-oldtime).seconds)
    pred,label,acc = predict(config)
    print(acc)
    fpr,tpr,roc_auc = cal_roc(pred,label)
    label = 'overlap ratio: %.1f' % (1-stride * 0.1)
    res.append([fpr,tpr,roc_auc,label])


savefig(res,0)
savefig(res,1)
savefig(res,'micro')
