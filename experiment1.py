from detector import *

res = []
strs = config['save_path'].strip('/')
checked = list(range(100,1000,100))
for wins in range(100, 1000, 200):
    config['maxlen'] = wins
    config['stride'] = int(wins*0.5)
    config['save_path'] = strs+'_wins'+str(config['maxlen'])+'/'
    maxs = 0.5
    if wins not in checked:
        config['batch_size'] = 30
        config['max_batch']=2000
        train(config, maxs)
    pred,label = predict(config)
    fpr,tpr,roc_auc = cal_roc(pred,label)
    label = 'windows length: %d' % wins
    res.append([fpr,tpr,roc_auc,label])

savefig(res,0)
savefig(res,1)
savefig(res,'micro')



